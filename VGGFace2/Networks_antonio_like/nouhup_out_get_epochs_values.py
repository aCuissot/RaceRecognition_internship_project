import matplotlib.pyplot as plt


def makeList(str):
    l = str.split("\n")
    l = l[:-1]
    acc = ""
    loss = ""
    acc_v = ""
    loss_v = ""
    for i in l:
        s = i.split(":")
        loss += s[1][:7] + ','
        acc += s[2][:7] + ','
        loss_v += s[3][:7] + ','
        acc_v += s[4][:7] + ','
    return loss, acc, loss_v, acc_v


f = open("data/nohup.out_vgg16_nds.txt", "r")
jaaj = 0
array = ""
for x in f:

    if x.__contains__("31250/31250"):
        print(x)
        jaaj += 1
        print("Epoch ", jaaj)
        array += x
l, a, lv, av = makeList(array)
print(l)
print(a)
print(lv)
print(av)
# for resnet
# loss = [0.4769, 0.3351, 0.2807, 0.2435, 0.2225, 0.2115, 0.1964, 0.1896, 0.1853, 0.1818, 0.1790, 0.1759, 0.1723, 0.171,
#         0.1696, 0.1684]
# acc = [0.8528, 0.8887, 0.9044, 0.9157, 0.9226, 0.9270, 0.9312, 0.9335, 0.9348, 0.9361, 0.9368, 0.9381, 0.9390, 0.9396,
#        0.9401, 0.9406]
# val_loss = [0.3388, 0.3234, 0.2613, 0.2362, 0.2534, 0.2263, 0.2183, 0.22, 0.2163, 0.2248, 0.2183, 0.2134, 0.2161,
#             0.2159, 0.2149, 0.2173]
# val_acc = [0.8857, 0.8919, 0.9124, 0.9206, 0.9228, 0.9256, 0.9282, 0.9273, 0.9293, 0.9272, 0.9296, 0.9315, 0.9304,
#            0.9311, 0.9312, 0.9319]

# for vgg16
# loss = [0.3468, 0.2391, 0.2146, 0.1999, 0.1906, 0.1860, 0.1733, 0.1707, 0.1678, 0.1668, 0.1656, 0.1624, 0.1594, 0.1598,
#         0.1588, 0.1578, 0.157]
# acc = [0.8846, 0.9183, 0.9266, 0.9310, 0.9342, 0.9361, 0.94, 0.9409, 0.9419, 0.9425, 0.9429, 0.9436, 0.9447, 0.9451,
#        0.9454, 0.9453, 0.9457]
# val_loss = [0.2505, 0.2148, 0.2245, 0.2333, 0.2208, 0.2056, 0.2061, 0.2115, 0.224, 0.2128, 0.2135, 0.2104, 0.2076,
#             0.2084, 0.2156, 0.2183, 0.2124]
# val_acc = [0.9181, 0.93, 0.9305, 0.9328, 0.936, 0.9369, 0.9366, 0.9378, 0.9368, 0.9381, 0.9378, 0.9389, 0.9383,
#            0.9388, 0.9383, 0.9381, 0.9381]

# for vggFace
# loss = [0.2246, 0.1685, 0.1484, 0.1361, 0.1273, 0.1206, 0.1131, 0.1092, 0.1072]
# acc = [0.9219, 0.9402, 0.9474, 0.9517, 0.9548, 0.9572, 0.9598, 0.9614, 0.962]
# val_loss = [0.2141, 0.2045, 0.2112, 0.2084, 0.2189, 0.2290, 0.2265, 0.223, 0.2252]
# val_acc = [0.9299, 0.9353, 0.9366, 0.9380, 0.9364, 0.936, 0.9375, 0.9369, 0.9368]

# for vggFace balanced
# loss = [0.3213, 0.2169, 0.1825, 0.1615, 0.1471, 0.137, 0.1257, 0.1202, 0.1168]
# acc = [0.8838, 0.9228, 0.9355, 0.9432, 0.9481, 0.952, 0.9561, 0.958, 0.9591]
# val_loss = [0.3191, 0.3547, 0.3662, 0.3606, 0.388, 0.4186, 0.3977, 0.4185, 0.4303]
# val_acc = [0.9033, 0.9003, 0.905, 0.9078, 0.9015, 0.9, 0.9049, 0.9029, 0.9003]

# # for vgg16 balanced
# loss = [0.3507, 0.2348, 0.1992, 0.1778, 0.1632, 0.1525, 0.1397, 0.1352, 0.1315]
# acc = [0.8722, 0.9166, 0.9295, 0.9374, 0.9423, 0.9464, 0.9511, 0.9526, 0.9539]
# val_loss = [0.325, 0.2946, 0.2906, 0.3023, 0.3162, 0.3529, 0.3275, 0.3364, 0.3481]
# val_acc = [0.9013, 0.9191, 0.9172, 0.9183, 0.9165, 0.9109, 0.9171, 0.9155, 0.9122]

# for resnet balanced
# loss = [0.3413, 0.2242, 0.189, 0.1673, 0.1531, 0.1426, 0.1306, 0.1258, 0.1227]
# acc = [0.8755, 0.9197, 0.9323, 0.9401, 0.9453, 0.9492, 0.9534, 0.9551, 0.9562]
# val_loss = [0.3537, 0.336, 0.3803, 0.3773, 0.4132, 0.4345, 0.4305, 0.4453, 0.4555]
# val_acc = [0.8922, 0.9039, 0.8986, 0.9041, 0.9004, 0.8956, 0.9017, 0.8979, 0.8992]

# for mobilenet:
# loss = [0.2630, 0.1968, 0.1789, 0.1665, 0.1595, 0.1537, 0.1469, 0.1439, 0.1415, 0.1405, 0.1388, 0.1373, 0.1356, 0.1345, 0.1343, 0.1335, 0.1329, 0.1318, 0.1320, 0.1318, 0.1314, 0.1316, 0.1312, 0.1311, 0.1308, 0.1303, 0.1302, 0.1307, 0.1296]
# acc = [0.9097, 0.9311, 0.9369, 0.9411, 0.9434, 0.9454, 0.9478, 0.9486, 0.9496, 0.9499, 0.9505, 0.9509, 0.9517, 0.9521, 0.9521, 0.9522, 0.9525, 0.9529, 0.9528, 0.9528, 0.9532, 0.9530, 0.9531, 0.9530, 0.9533, 0.9534, 0.9535, 0.9533, 0.9535]
# val_loss = [0.2377, 0.2252, 0.2334, 0.2185, 0.2174, 0.2201, 0.2194, 0.2134, 0.2223, 0.2199, 0.2235, 0.2268, 0.2216, 0.2261, 0.2221, 0.2238, 0.2238, 0.2245, 0.2222, 0.2254, 0.2257, 0.2220, 0.2240, 0.2233, 0.2232, 0.2242, 0.2248, 0.2240, 0.2246]
# val_acc = [0.9201, 0.9286, 0.9276, 0.9298, 0.9326, 0.9328, 0.9332, 0.9335, 0.9325, 0.9340, 0.9332, 0.9338, 0.9337, 0.9341, 0.9347, 0.9343, 0.9348, 0.9342, 0.9351, 0.9349, 0.9340, 0.9346, 0.9345, 0.9349, 0.9349, 0.9345, 0.9345, 0.9346, 0.9346]

# for mobilenet balanced
# loss = [0.3960, 0.2799, 0.2466, 0.2253, 0.2112, 0.2012, 0.1893, 0.1838, 0.1805, 0.1775, 0.1753, 0.1729, 0.1704, 0.1687,
#         0.1684]
# acc = [0.8553, 0.8991, 0.9115, 0.9190, 0.9242, 0.9278, 0.9321, 0.9341, 0.9353, 0.9364, 0.9371, 0.9380, 0.9391, 0.9394,
#        0.9396]
# val_loss = [0.3405, 0.3462, 0.3495, 0.3673, 0.3374, 0.3580, 0.3563, 0.3482, 0.3535, 0.3546, 0.3527, 0.3643, 0.3576,
#             0.3689, 0.3670]
# val_acc = [0.8907, 0.8909, 0.8950, 0.8935, 0.9000, 0.8957, 0.8996, 0.9004, 0.9006, 0.8998, 0.9003, 0.8995, 0.9009,
#            0.8998, 0.8986]

# New Dataset
# mobilenet:
# loss = [0.3301, 0.2421, 0.2243, 0.2140, 0.2076, 0.2032, 0.1991, 0.1967, 0.1962, 0.1947, 0.1933, 0.1926, 0.1920]
# acc = [0.8883, 0.9165, 0.9221, 0.9257, 0.9277, 0.9291, 0.9305, 0.9315, 0.9315, 0.9318, 0.9323, 0.9327, 0.9329]
# val_loss = [0.2577, 0.2398, 0.2359, 0.2289, 0.2263, 0.2295, 0.2253, 0.2252, 0.2247, 0.2248, 0.2225, 0.2257, 0.2248]
# val_acc = [0.9115, 0.9188, 0.9200, 0.9234, 0.9254, 0.9256, 0.9262, 0.9263, 0.9267, 0.9271, 0.9272, 0.9268, 0.9270]

# resnet
# loss = [0.2558, 0.1827, 0.1639, 0.1517, 0.1445, 0.1388, 0.1318, 0.1298, 0.1275, 0.1261, 0.1248, 0.1234, 0.1216, 0.1210, 0.1207]
# acc = [0.9133, 0.9369, 0.9433, 0.9474, 0.9497, 0.9518, 0.9541, 0.9546, 0.9554, 0.9559, 0.9564, 0.9567, 0.9574, 0.9577, 0.9574]
# val_loss = [0.2230, 0.2141, 0.2229, 0.2270, 0.2312, 0.2279, 0.2308, 0.2384, 0.2350, 0.2399, 0.2367, 0.2395, 0.2403, 0.2391, 0.2400]
# val_acc = [0.9265, 0.9322, 0.9323, 0.9332, 0.9328, 0.9343, 0.9343, 0.9348, 0.9351, 0.9357, 0.9353, 0.9357, 0.9354, 0.9357, 0.9356]

# vgg16
# loss = [0.2340, 0.1743, 0.1557, 0.1428, 0.1348, 0.1290, 0.1197, 0.1167, 0.1153, 0.1129, 0.1111, 0.1095, 0.1072, 0.1072, 0.1057, 0.1054, 0.1050, 0.1047, 0.1035, 0.1036]
# acc = [0.9195, 0.9393, 0.9456, 0.9499, 0.9528, 0.9546, 0.9579, 0.9588, 0.9595, 0.9602, 0.9611, 0.9616, 0.9623, 0.9623, 0.9629, 0.9629, 0.9630, 0.9632, 0.9637, 0.9635]
# val_loss = [0.1987, 0.1892, 0.1936, 0.1893, 0.2053, 0.2090, 0.2081, 0.2135, 0.2111, 0.2114, 0.2164, 0.2188, 0.2204, 0.2213, 0.2228, 0.2194, 0.2220, 0.2262, 0.2236, 0.2222]
# val_acc = [0.9356, 0.9389, 0.9407, 0.9420, 0.9417, 0.9394, 0.9420, 0.9411, 0.9417, 0.9420, 0.9421, 0.9416, 0.9419, 0.9422, 0.9417, 0.9426, 0.9419, 0.9414, 0.9420, 0.9423]

# vggface:
loss = [0.2273, 0.1709, 0.1512, 0.1372, 0.1295, 0.1224, 0.1139, 0.1103, 0.1085, 0.1057, 0.1043, 0.1034]
acc = [0.9220, 0.9405, 0.9470, 0.9519, 0.9546, 0.9571, 0.9600, 0.9613, 0.9621, 0.9629, 0.9633, 0.9639]
val_loss = [0.2261, 0.2218, 0.2129, 0.2212, 0.2140, 0.2346, 0.2164, 0.2220, 0.2287, 0.2349, 0.2266, 0.2379]
val_acc = [0.9273, 0.9330, 0.9366, 0.9373, 0.9372, 0.9377, 0.9402, 0.9390, 0.9393, 0.9391, 0.9400, 0.9397]

fig, ax = plt.subplots()
ax.plot(loss, 'r', label='loss')
ax.plot(acc, 'g', label='acc')
ax.plot(val_loss, 'r--', label='val_loss')
ax.plot(val_acc, 'g--', label='val_acc')
plt.xlabel("Epochs")
legend = ax.legend(loc='center', shadow=True, fontsize='x-large')

# Put a nicer background color on the legend.
legend.get_frame().set_facecolor('C0')

plt.show()
# plt.plot(loss, 'r')
# plt.plot(acc, 'b')
# plt.plot(val_loss, 'k')
# plt.plot(val_acc, 'g')
# plt.show()
